It is a challenge to obtain individual pairs of data as a representative sample. Although it is easy to send out a spreadsheet and ask our friends to report their scores anonymously, this approach can result in a large selection bias. Many of our friends graduated from the same high school and/or college, so we are likely to have similar entrance exam scores.

Hence we retrieved data from the SENIORHIGH (high school)^[<https://www.ptt.cc/bbs/SENIORHIGH/M.1432729401.A.995.html>] discussion section on PTT,^[If you have a PTT account, you can log into the website using a browser. <https://term.ptt.cc/>] the largest terminal-based bulletin board in Taiwan.^[<https://en.wikipedia.org/wiki/PTT_Bulletin_Board_System>] We assume the data to be more representative (than if we had collected on our own) because anyone could get a PTT account and reply to the post -- at least before the restriction was announced in 2018.^[<https://www.ettoday.net/news/20200304/1659455.htm>] The majority of scores were reported in May 2015, and a few scores were reported in the following month or later. The records indicate that each respondent had taken the college entrance exam in the year 2015 or earlier, so we can safely assume that neither of them had taken the new form of high school entrance exam starting in 2014.   

The dataset `ptt_SENIORHIGH_data.csv` contains 197 rows, and the main variables are:

- **pttID**: Each person's ID on PTT, which can be anonymous. This column serves as the unique identifier of each person.
- **HighSchool_PR**: Each person's percentile rank (PR) of the high school entrance exam in Taiwan, ranging from 0 to 99.
- **College_Score**: Each person's General Scholastic Ability Test (GSAT) score, ranging from 0 to 75.  

There are 6 missing values in **HighSchool_PR** and 3 missing values in **College_Score**, so each of them is manually recorded as "-1" (an invalid numerical value for the scores).   

In some cases, the reported scores can be inaccurate based on the respondent's description, so we created two indicators for this issue:  

- **HS_Inacc**: A "1" means the reported **HighSchool_PR** is inaccurate.
- **CS_Inacc**: A "1" means the reported **College_Score** is inaccurate.  

One obvious reason of inaccurate scores is that a respondent may comment that his/her scores are approximate. Moreover, some people reported their **HighSchool_PR** from the mock exam, rather than from the actual high school entrance exam. In 2012 and 2013, the Ministry of Education in Taiwan allowed students to apply for high schools with their grades in middle school. During that time, if a student got admitted to a high school using this method, he/she would not need to take the high school entrance exam.^[<https://tsjh301.blogspot.com/2014/06/compulsory-education.html>]  

For **College_Score**, the approximate clause still applies. In addition, there are two college entrance exams in each school year, and some students may do much better on the second exam than the first one. Then they were admitted to a more prestigious school than the first exam score had indicated, so this is also a form of inaccuracy.  

\section*{\textcolor{red}{Unfinished below}}  

Let's clean up the data.  

What did we do in cleaning up?  

- **HS_Invalid**: A "1" means the reported **HighSchool_PR** is invalid, i.e., outside the range of 1-99.
- **CS_Invalid**: A "1" means the reported **College_Score** is invalid, i.e., outside the range of 1-75.

```{r data-cleaning-initial}
data = read.csv("ptt_SENIORHIGH_data.csv")

names(data)[1] = "pttID" # system read in as "i..pttID", need to correct this

data$HS_Inacc[is.na(data$HS_Inacc)] = 0
data$CS_Inacc[is.na(data$CS_Inacc)] = 0

data$HS_Invalid = 0
data$HS_Invalid[(data$HighSchool_PR > 99)|(data$HighSchool_PR < 1)] = 1

data$CS_Invalid = 0
data$CS_Invalid[(data$CS_Score > 75)|(data$CS_Score < 1)] = 1
```


We can save the clean version to a separate `.csv` file for future use.  

```{r save-data-clean, eval=FALSE}
write.csv(data, "ptt_SENIORHIGH_data_clean.csv")
```

The inaccuracy flag is confusing. Consider adding another set of flags: **HS_Invalid** and **CS_Invalid**.  

Generate such flags with code, rather than by hand ?!  

\textcolor{red}{Inaccurate does not mean the score is invalid.}  

Change the missing values to zero in **HS_Inacc** and **CS_Inacc**?    

\textcolor{red}{Need to explain some respondents' inaccurate reporting.}  

e.g.  The respondent `game275415` provided an approximate value to the **HighSchool_PR**.   

\section*{\textcolor{red}{Unfinished above}}   





## Data Snapshot

We show the first 10 rows of data here, and `NA` (not available) denotes that the value is missing. Note that only **HS_Inacc** and **CS_Inacc** contain `NA`s, because we already recoded missing values to "-1" (an invalid numeric value) for **HighSchool_PR** and **College_Score**.  

We also observed that **pttID** contains some information for potential inference, although we are not going to use it. For example, the 6th respondent `robinyu85` could be someone named Robin Yu, and the 8th respondent `godpatrick11` may have the English name Patrick. Nevertheless, this kind of information is simply a heuristic, so it is neither sufficient nor appropriate to include in the data analysis.

```{r set-width, include=FALSE}
default_value = getOption("width") # 80
# print(default_value)

# Increase the width to print all data column names on a single line.
options(width = 200)
```


```{r raw-data}
data[1:10,]
```

```{r restore-width, include=FALSE}
# Now we reset the width back to default for the rest of the document.
options(width = default_value)
```

**Remark**: Data in the real world are messy, and data scientists spend lots of time cleaning (preprocessing) the data, i.e., preparing the data for analysis.^[<https://bit.ly/303IWxY>] But data cleaning is a necessary step for better analysis results, and there are some visualization examples that demonstrate the importance of preprocessing the data \cite{chai2020importance}. Our dataset `ptt_SENIORHIGH_data.csv` is relatively clean, but we still had to recode and flag missing values.  


## Bivariate Validation

We need to clean up the data to prepare for the analysis. For example, we would like to investigate the relationship between **HighSchool_PR** and **College_Score**, we need to ensure that each record consists of both valid scores. There are 191 records of valid **HighSchool_PR** numbers in the data, but if we consider only the ones with a valid **College_Score**, the number of available records drops to 188. Although which version we use does not matter much when we look at the univariate distribution, this will be problematic when we combine the univariate analysis with the bivariate analysis. Thus, we should use only the 188 records whose **College_Score** numbers are also valid.  

```{r high-school-pr80up-univ}
# High school entrance exam scores: Remove missing values
uni_HS_score = data$HighSchool_PR[which(data$HighSchool_PR != -1)]
length(uni_HS_score)
```

\section*{\textcolor{red}{Unfinished below}}  

\textcolor{red}{Need to explain} `data_corr`  

Missing values in one of **HighSchool_PR** or **College_Score**  

We do not have sufficient information to impute such missing values in our dataset, so we decided to exclude them.  

Pointer to record linkage methods ?!  

\section*{\textcolor{red}{Unfinished above}}  

```{r data-corr-undefined}
missing_rows = which(data$HighSchool_PR == "-1" | data$College_Score == "-1")
# Indices: 6 19 71 85 88 96 132 183 195 => nine in total
# Remove missing data
data_corr = data[-missing_rows,]
```

```{r high-school-pr80up-bivar}
# Consider only the records with both valid HighSchool_PR and College_Score
length(data_corr$HighSchool_PR)
```

The same requirement also applies to **College_Score**. There are 194 records of valid **College_Score** numbers in the data, but only 188 of them also have corresponding valid **HighSchool_PR** numbers. Accordingly, we should use only the 188 records whose **HighSchool_PR** numbers are also valid.  

```{r college-score60up}
# College entrance exam scores: Remove missing values
uni_college_score = data$College_Score[which(data$College_Score != -1)]
length(uni_college_score)
```

```{r college-score60up-bivar}
# Consider only the records with both valid HighSchool_PR and College_Score
length(data_corr$College_Score)
```